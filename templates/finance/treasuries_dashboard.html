{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<style>
    .treasuries-dashboard {
        padding: 20px;
        font-family: 'Segoe UI', Tahoma, sans-serif;
    }

    .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
    }

    .dashboard-header h1 {
        color: #D4AF37;
        margin: 0;
        font-size: 28px;
    }

    .today-date {
        background: linear-gradient(135deg, #D4AF37, #B8860B);
        color: #000;
        padding: 10px 20px;
        border-radius: 10px;
        font-weight: bold;
    }

    /* Summary Cards */
    .summary-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .summary-card {
        background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
        border-radius: 15px;
        padding: 20px;
        border: 1px solid #333;
        text-align: center;
    }

    .summary-card.gold {
        border-color: #D4AF37;
        background: linear-gradient(135deg, #1a1a1a, #2a2518);
    }

    .summary-card.cash {
        border-color: #4CAF50;
        background: linear-gradient(135deg, #1a1a1a, #1a2a1a);
    }

    .summary-card .value {
        font-size: 28px;
        font-weight: bold;
        color: #D4AF37;
        margin: 10px 0;
    }

    .summary-card.cash .value {
        color: #4CAF50;
    }

    .summary-card .label {
        color: #888;
        font-size: 14px;
    }

    /* Treasury Cards */
    .treasury-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 25px;
        margin-bottom: 30px;
    }

    .treasury-card {
        background: linear-gradient(135deg, #1f1f1f, #2d2d2d);
        border-radius: 15px;
        padding: 25px;
        border: 1px solid #444;
        transition: all 0.3s ease;
    }

    .treasury-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(212, 175, 55, 0.2);
        border-color: #D4AF37;
    }

    .treasury-card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid #333;
    }

    .treasury-name {
        font-size: 18px;
        font-weight: bold;
        color: #fff;
    }

    .treasury-type {
        background: #D4AF3722;
        color: #D4AF37;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 12px;
    }

    .treasury-balances {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
    }

    .balance-item {
        background: #111;
        padding: 15px;
        border-radius: 10px;
        text-align: center;
    }

    .balance-item .amount {
        font-size: 20px;
        font-weight: bold;
        color: #D4AF37;
    }

    .balance-item.cash .amount {
        color: #4CAF50;
    }

    .balance-item .type {
        color: #888;
        font-size: 12px;
        margin-top: 5px;
    }

    /* Today's Activity */
    .today-activity {
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #333;
        display: flex;
        justify-content: space-around;
    }

    .activity-item {
        text-align: center;
    }

    .activity-item .in {
        color: #4CAF50;
        font-weight: bold;
    }

    .activity-item .out {
        color: #f44336;
        font-weight: bold;
    }

    .activity-item .net {
        font-weight: bold;
    }

    .activity-item .net.positive {
        color: #4CAF50;
    }

    .activity-item .net.negative {
        color: #f44336;
    }

    /* Recent Transfers */
    .transfers-section {
        background: linear-gradient(135deg, #1f1f1f, #2d2d2d);
        border-radius: 15px;
        padding: 25px;
        border: 1px solid #444;
    }

    .transfers-section h3 {
        color: #D4AF37;
        margin-bottom: 20px;
    }

    .transfer-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px;
        background: #111;
        border-radius: 8px;
        margin-bottom: 10px;
    }

    .transfer-direction {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .transfer-arrow {
        color: #D4AF37;
        font-size: 20px;
    }

    .quick-actions {
        display: flex;
        gap: 15px;
        margin-top: 20px;
    }

    .action-btn {
        flex: 1;
        padding: 15px;
        border-radius: 10px;
        text-decoration: none;
        text-align: center;
        font-weight: bold;
        transition: all 0.3s ease;
    }

    .action-btn.primary {
        background: linear-gradient(135deg, #D4AF37, #B8860B);
        color: #000;
    }

    .action-btn.secondary {
        background: #333;
        color: #fff;
        border: 1px solid #D4AF37;
    }

    .action-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 20px rgba(212, 175, 55, 0.3);
    }
</style>

<div class="treasuries-dashboard">
    <div class="dashboard-header">
        <h1>ğŸ¦ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ù„Ø®Ø²Ø§Ø¦Ù†</h1>
        <div class="today-date">ğŸ“… {{ today }}</div>
    </div>

    <!-- Summary Cards -->
    <div class="summary-cards">
        <div class="summary-card cash">
            <div class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©</div>
            <div class="value">{{ totals.cash|floatformat:2 }} Ø¬.Ù…</div>
        </div>
        <div class="summary-card gold">
            <div class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø°Ù‡Ø¨ 21</div>
            <div class="value">{{ totals.gold_21|floatformat:3 }} Ø¬Ù…</div>
        </div>
        <div class="summary-card gold">
            <div class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø°Ù‡Ø¨ 18</div>
            <div class="value">{{ totals.gold_18|floatformat:3 }} Ø¬Ù…</div>
        </div>
        <div class="summary-card gold">
            <div class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø°Ù‡Ø¨ 24</div>
            <div class="value">{{ totals.gold_24|floatformat:3 }} Ø¬Ù…</div>
        </div>
        <div class="summary-card">
            <div class="label">Ø°Ù‡Ø¨ Ø§Ù„Ø³Ø¨Ùƒ</div>
            <div class="value" style="color:#FF9800;">{{ totals.gold_casting|floatformat:3 }} Ø¬Ù…</div>
        </div>
        <div class="summary-card">
            <div class="label">Ø§Ù„Ø£Ø­Ø¬Ø§Ø±</div>
            <div class="value" style="color:#9C27B0;">{{ totals.stones|floatformat:3 }}</div>
        </div>
    </div>

    <!-- Treasury Cards -->
    <div class="treasury-grid">
        {% for item in treasury_data %}
        <div class="treasury-card">
            <div class="treasury-card-header">
                <span class="treasury-name">{{ item.treasury.name }}</span>
                <span class="treasury-type">{{ item.treasury.get_treasury_type_display }}</span>
            </div>

            <div class="treasury-balances">
                <div class="balance-item cash">
                    <div class="amount">{{ item.cash_balance|floatformat:2 }}</div>
                    <div class="type">ğŸ’µ Ù†Ù‚Ø¯ÙŠØ©</div>
                </div>
                <div class="balance-item">
                    <div class="amount">{{ item.total_gold|floatformat:3 }}</div>
                    <div class="type">âœ¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø°Ù‡Ø¨</div>
                </div>
                <div class="balance-item">
                    <div class="amount" style="color:#2196F3;">{{ item.gold_21|floatformat:3 }}</div>
                    <div class="type">Ø°Ù‡Ø¨ 21</div>
                </div>
                <div class="balance-item">
                    <div class="amount" style="color:#FF9800;">{{ item.gold_18|floatformat:3 }}</div>
                    <div class="type">Ø°Ù‡Ø¨ 18</div>
                </div>
            </div>

            <div class="today-activity">
                <div class="activity-item">
                    <div class="in">+{{ item.cash_in_today|floatformat:2 }}</div>
                    <div class="type">ÙˆØ§Ø±Ø¯ Ø§Ù„ÙŠÙˆÙ…</div>
                </div>
                <div class="activity-item">
                    <div class="out">-{{ item.cash_out_today|floatformat:2 }}</div>
                    <div class="type">ØµØ§Ø¯Ø± Ø§Ù„ÙŠÙˆÙ…</div>
                </div>
                <div class="activity-item">
                    <div class="net {% if item.net_today >= 0 %}positive{% else %}negative{% endif %}">
                        {{ item.net_today|floatformat:2 }}
                    </div>
                    <div class="type">Ø§Ù„ØµØ§ÙÙŠ</div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="treasury-card" style="text-align:center; color:#888;">
            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®Ø²Ø§Ø¦Ù† Ù…Ø³Ø¬Ù„Ø©
        </div>
        {% endfor %}
    </div>

    <!-- Recent Transfers -->
    <div class="transfers-section">
        <h3>ğŸ”„ Ø¢Ø®Ø± Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª</h3>
        {% for transfer in recent_transfers %}
        <div class="transfer-item">
            <div class="transfer-direction">
                <span>{{ transfer.from_treasury.name }}</span>
                <span class="transfer-arrow">â¡ï¸</span>
                <span>{{ transfer.to_treasury.name }}</span>
            </div>
            <div>
                <span style="color:#4CAF50; font-weight:bold;">{{ transfer.cash_amount|floatformat:2 }} Ø¬.Ù…</span>
                {% if transfer.gold_weight > 0 %}
                <span style="color:#D4AF37; margin-right:15px;">{{ transfer.gold_weight|floatformat:3 }} Ø¬Ù…</span>
                {% endif %}
            </div>
        </div>
        {% empty %}
        <div style="text-align:center; color:#888; padding:20px;">
            Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ­ÙˆÙŠÙ„Ø§Øª Ø­Ø¯ÙŠØ«Ø©
        </div>
        {% endfor %}
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <a href="/admin/finance/treasury/add/" class="action-btn primary">â• Ø¥Ø¶Ø§ÙØ© Ø®Ø²ÙŠÙ†Ø©</a>
        <a href="/admin/finance/treasurytransfer/add/" class="action-btn secondary">ğŸ”„ ØªØ­ÙˆÙŠÙ„ Ø¬Ø¯ÙŠØ¯</a>
        <a href="/admin/finance/treasurytransaction/add/" class="action-btn secondary">ğŸ“ Ø­Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©</a>
        <a href="/finance/daily-close/" class="action-btn secondary">ğŸ”’ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</a>
    </div>
</div>
{% endblock %}